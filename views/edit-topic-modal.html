<div 
    class="modal-overlay" 
    x-show="isEditTopicModalOpen" 
    x-cloak 
    @keydown.escape.window="isEditTopicModalOpen = false"
>
    <div class="modal-content" @click.outside="isEditTopicModalOpen = false">
        <h3>Edit Topic</h3>
        <template x-if="editingTopic">
            <textarea
                x-model="editingTopic.title"
                @keydown.enter="
                    if (!$event.shiftKey) {
                        $event.preventDefault();
                        dataLayer.updateTopicTitle(editingTopic.id, editingTopic.title);
                        isEditTopicModalOpen = false;
                        editingTopic = null;
                    }
                "
            ></textarea>
        </template>
        <div class="modal-actions">
            <div>
                <button 
                    class="btn-delete"
                    @click="
                        if (confirm('Are you sure you want to delete this topic and ALL its goals and logs?')) {
                            dataLayer.deleteTopic(editingTopic.id);
                            topics = topics.filter(t => t.id !== editingTopic.id);
                            isEditTopicModalOpen = false;
                            editingTopic = null;
                        }
                    "
                >Delete</button>
            </div>
            <div class="right-actions">
                <button @click="isEditTopicModalOpen = false; editingTopic = null">Cancel</button>
                <button 
                    class="btn-save"
                    @click="
                        dataLayer.updateTopicTitle(editingTopic.id, editingTopic.title);
                        isEditTopicModalOpen = false; 
                        editingTopic = null;
                    "
                >Save Changes</button>
            </div>
        </div>
    </div>
</div>