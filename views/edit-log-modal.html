<div
    class="modal-overlay"
    x-show="isEditLogModalOpen"
    x-cloak
    @keydown.escape.window="isEditLogModalOpen = false"
>
    <div class="modal-content" @click.outside="isEditLogModalOpen = false">
        <h3>Edit Log</h3>
        <template x-if="editingLog">
            <textarea
                x-model="editingLog.entry"
                @keydown.enter="
                    if (!$event.shiftKey) {
                        $event.preventDefault();
                        dataLayer.updateLog(editingLog.id, editingLog.entry);
                        isEditLogModalOpen = false;
                    }
                "
            ></textarea>
        </template>
        <div class="modal-actions">
            <div>
                <button
                    class="btn-delete"
                    @click="
                        if (confirm('Are you sure you want to delete this log entry?')) {
                            const statsUpdated = await dataLayer.deleteLog(editingLog, editingLogGoal);
                            if (statsUpdated) isRepertoireStale = true;
                            if (editingLogGoal) {
                                editingLogGoal.logs = editingLogGoal.logs.filter(l => l.id !== editingLog.id);
                            }
                            isEditLogModalOpen = false;
                        }
                    "
                >Delete</button>
            </div>
            <div class="right-actions">
                <button @click="isEditLogModalOpen = false">Cancel</button>
                <button
                    class="btn-save"
                    @click="
                        dataLayer.updateLog(editingLog.id, editingLog.entry);
                        isEditLogModalOpen = false;
                    "
                >Save Changes</button>
            </div>
        </div>
    </div>
</div>
